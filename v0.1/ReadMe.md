This is the primariy version I implement in May 2013. The code is really terrible.
